{{> layout/header}}

<style>
	/* .modal { */
	/* display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7); */
	/* } */

	.modal-content {
		background-color: #fff;
		margin: 15% auto;
		padding: 20px;
		border: 1px solid #888;
		width: 400px;
		height: 150px;
		position: relative;
		left: 0%;
		top: -15%;
		max-height: calc(80% - 100px); /* í™”ë©´ ë†’ì´ì—ì„œ 40px ì œì™¸ */
		max-width: calc(80% - 40px); /* í™”ë©´ ë†’ì´ì—ì„œ 40px ì œì™¸ */
		overflow-y: auto;
	}

	.close {
		color: #aaa;
		float: right;
		font-size: 28px;
		font-weight: bold;
	}

	.close:hover,
	.close:focus {
		color: black;
		text-decoration: none;
		cursor: pointer;
	}

	.modal-backdrop {
		display: none;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.25);
		z-index: 1; /* ëª¨ë‹¬ë³´ë‹¤ ìœ„ì— í‘œì‹œë˜ë„ë¡ ì„¤ì • */
	}

	/* ëª¨ë‹¬ í™œì„±í™” ì‹œ ë°±ë“œë¡­ í‘œì‹œ */
	.modal.active + .modal-backdrop {
		display: block;
	}
</style>

<!-- ë©”ì¸í˜ì´ì§€(ì¸ë±ìŠ¤) í™”ë©´-->
<!-- 1, 6, 7, 8, 9 í™”ë©´ ì—°ê´€-->
<!-- TODO ë¡œê·¸ì¸ì „, í›„ NavBar ì„¤ì • í•„ìš”  -->

<div class="d-flex justify-content-center align-items-center">
	<div class="col-auto"></div>

	<div class="col-xxl-7 col-xl-9 col-lg-10 col-md-11 col-sm-12">
		<form action="/" method="get" id="selectform">
			<!-- form="selectform"ë‘ id ê°™ê²Œ í•´ì•¼ ë°›ì•„ì˜´  -->
			<div class="d-flex justify-content-around ps-4 pe-4">
				<div class="order-2 m-2 border border-info col-4">
					<h4 class="mt-2 text-center mb-0">ê¸°ìˆ ë³„</h4>

					<div class="d-flex justify-content-between">
						<div class="form-check d-inline-block ms-3 me-2 align-self-end">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="checkbox"
									name="skillList"
									id="all"
									value="all"
									onclick="skillCheck(this)"
								/>
								ëª¨ë‘</label
							>
						</div>
						<div
							class="btn btn-primary me-3 m-1 mt-0 btn-sm"
							onclick="searchOnlySkill()"
						>
							ê¸°ìˆ ë§Œ ê²€ìƒ‰
						</div>
					</div>

					<hr class="m-1"/>
					<div class="d-flex flex-wrap">
						{{#skillList}}
							<div class="form-check d-inline-block ms-3 me-2">
								<label class="form-check-label">
									<input
										class="skillFind form-check-input"
										type="checkbox"
										name="skillList"
										value="{{ skillname }}"
										id="{{ skillname }}"
										onclick="skillAllCheck()"
									/>
									{{ skillname }}</label
								>
							</div>
						{{/skillList}}
					</div>
				</div>

				<div class="order-1 m-2 border border-info col-4">
					<h4 class="mt-2 text-center mb-0">ì§€ì—­ë³„</h4>

					<div class="d-flex justify-content-between">
						<div class="form-check d-inline-block ms-3 me-2 align-self-end">
							<label class="form-check-label">
								<input
									class="form-check-input all3checkbox"
									type="checkbox"
									name=""
									id=""
									value=""
									onclick="regionCheck(this)"
								/>
								ëª¨ë‘</label
							>
						</div>
						<div
							class="btn btn-primary me-3 m-1 mt-0 btn-sm"
							onclick="searchOnlyRegion()"
						>
							ì§€ì—­ë§Œ ê²€ìƒ‰
						</div>
					</div>

					<hr class="m-1"/>

					<div class="d-flex justify-content-around p-1">
						<div class="d-flex justify-content-center">
							<select
								class="me-2"
								name="region"
								form="selectform"
								onchange="regionCheck2(this)"
							>
								<option class="all3" id="all3" value="all">ì„ íƒí•˜ì„¸ìš”.</option>
								<option id="ì„œìš¸" value="ì„œìš¸">ì„œìš¸/ì¸ì²œ/ê²½ê¸°</option>
								<option id="ë¶€ì‚°" value="ë¶€ì‚°">ë¶€ì‚°/ìš¸ì‚°/ê²½ë‚¨</option>
								<option id="ëŒ€êµ¬" value="ëŒ€êµ¬">ëŒ€êµ¬/ê²½ë¶</option>
								<option id="ê´‘ì£¼" value="ê´‘ì£¼">ê´‘ì£¼/ì „ë¼</option>
								<option id="ëŒ€ì „" value="ëŒ€ì „">ëŒ€ì „/ì„¸ì¢…/ì¶©ì²­</option>
								<option id="ê°•ì›" value="ê°•ì›">ê°•ì›</option>
								<option id="ì œì£¼" value="ì œì£¼">ì œì£¼</option>
							</select>

							<select class="">
								<option id="" value="">ì„ íƒí•˜ì„¸ìš”.</option>
								<option value="ê°•ì„œêµ¬">ê°•ì„œêµ¬</option>
								<option value="ê¸ˆì •êµ¬">ê¸ˆì •êµ¬</option>
								<option value="ë‚¨êµ¬">ë‚¨êµ¬</option>
								<option value="ë™êµ¬">ë™êµ¬</option>
								<option value="ë™ë˜êµ¬">ë™ë˜êµ¬</option>
							</select>
						</div>
					</div>
				</div>

				<div class="order-3 m-2 border border-info col-4">
					<h4 class="mt-2 text-center mb-0">ì§ë¬´ë³„</h4>

					<div class="d-flex justify-content-between">
						<div class="form-check d-inline-block ms-3 me-2 align-self-end">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="all2"
									name="position"
									value="all"
								/>
								ëª¨ë‘</label
							>
						</div>
						<div
							class="btn btn-primary me-3 m-1 mt-0 btn-sm"
							onclick="searchOnlyPosition()"
						>
							ì§ë¬´ë§Œ ê²€ìƒ‰
						</div>
					</div>

					<hr class="m-1"/>

					<div class="d-flex flex-wrap">
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="ë°±ì—”ë“œ"
									name="position"
									value="ë°±ì—”ë“œ"
								/>
								ë°±ì—”ë“œ</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="í”„ë¡ íŠ¸ì—”ë“œ"
									name="position"
									value="í”„ë¡ íŠ¸ì—”ë“œ"
								/>
								í”„ë¡ íŠ¸ì—”ë“œ</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="í’€ìŠ¤íƒ"
									name="position"
									value="í’€ìŠ¤íƒ"
								/>
								í’€ìŠ¤íƒ</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="ì•ˆë“œë¡œì´ë“œ"
									name="position"
									value="ì•ˆë“œë¡œì´ë“œ"
								/>
								ì•ˆë“œë¡œì´ë“œ</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="IOS"
									name="position"
									value="IOS"
								/>
								IOS</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="ì„ë² ë””ë“œ"
									name="position"
									value="ì„ë² ë””ë“œ"
								/>
								ì„ë² ë””ë“œ</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="ë¹…ë°ì´í„°"
									name="position"
									value="ë¹…ë°ì´í„°"
								/>
								ë¹…ë°ì´í„°</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="ì„œë²„"
									name="position"
									value="ì„œë²„"
								/>
								ì„œë²„</label
							>
						</div>
						<div class="form-check d-inline-block ms-3 me-2">
							<label class="form-check-label">
								<input
									class="form-check-input"
									type="radio"
									id="ë¨¸ì‹ ëŸ¬ë‹"
									name="position"
									value="ë¨¸ì‹ ëŸ¬ë‹"
								/>
								ë¨¸ì‹ ëŸ¬ë‹</label
							>
						</div>
					</div>
				</div>
			</div>
			<div class="m-2 mb-3">
				<div class="btn btn-light w-100 big-search" onclick="searchAll()">
					ê²€ìƒ‰í•˜ê¸°
				</div>
			</div>

			<textarea
				class="visually-hidden"
				id="pageFind"
				name="page"
				rows="1"
				cols="50"
			>{{#page}}{{ page }}{{/page}}{{^page}}0{{/page}}</textarea
			>

			<div class="text-center">
				êµ¬ì¸ê³µê³  ê²€ìƒ‰ ê²°ê³¼ : ì´í•© <b>{{ totalCount }}</b
			>ê°œ, <b>{{ totalPage }}</b
			>í˜ì´ì§€
			</div>
			<ul class="pagination d-flex justify-content-center mt-1">
				<li class="page-item {{#first}}disabled{{/first}}">
					<button class="page-link" onclick="searchAllPageMinus()">
						ì´ì „ í˜ì´ì§€
					</button>
				</li>
				<li class="page-item">
					<div class="page-link">
						{{#page}}{{ page }}{{/page}}{{^page}}0{{/page}}
					</div>
				</li>
				<li class="page-item {{#last}}disabled{{/last}}">
					<button class="page-link" onclick="searchAllPagePlus()">
						ë‹¤ìŒ í˜ì´ì§€
					</button>
				</li>
			</ul>
		</form>

		<div class="mb-4 d-flex flex-wrap">
			{{#postingList}}
				{{#col3}}
				<div class="col-lg-4 col-md-4 col-sm-6">
				{{/col3}}
				{{^col3}}
				<div class="col-lg-3 col-md-4 col-sm-6">
				{{/col3}}
				<div class="border border-info m-2 ps-2 pe-2 pt-1">
					<h4 class="text-center fw-bold">{{ user.compname }}</h4>
					{{#user.photo




					}}<a
						href="/comp/posting/{{ id }}"
						class="text-black text-decoration-none"
					><img
						src="/images/{{ user.photo }}"
						class="img-fluid d-block m-auto"
						style="height: 120px"
					/>{{/user.photo}}
					{{^user.photo




					}}<a
						href="/comp/posting/{{ id }}"
						class="text-black text-decoration-none"
					><img
						src="/images/no_logo.png"
						class="img-fluid d-block m-auto"
						style="height: 120px"
					/>{{/user.photo}}
					<h5 class="mt-1 fw-bold">{{ title }}</h5>
					<div class="mb-1 fst-italic">{{ position }}</div>
					<div class="mb-1">
						{{#postingSkill




						}}<span
							class="badge me-1"
							style="background-color: #7f00ff"
						>{{ skill.skillname }}</span
						>{{/postingSkill}}
					</div>
					<div>
						{{#career




						}}<span class="badge" style="background-color: #f9b233">{{
						career
						}}</span
						>{{/career}}
						{{#education




						}}<span class="badge" style="background-color: #f27d0c">{{
						education
						}}</span
						>{{/education}}
						<span class="badge" style="background-color: #f95959">{{
						region
						}}</span>
					</div>
				</a>
				</a>
					<div class="d-flex justify-content-between">
						{{^sessionComp.compname}}
							<button
								type="button"
								class="border-0 bg-white mt-1 like-button"
								id="posting{{ id }}"
								onclick="bookmarkChange(`{{ id }}`)"
							>
								<h3>ğŸ¤</h3></button
							>{{/sessionComp.compname}}
						<!-- <button type="button" class="border-0 bg-white mt-2"><h3>â¤ï¸</h3></button> -->
						<!-- ê¸°ì—… ìœ ì €ëŠ” ë¶ë§ˆí¬ ëª»í•˜ê²Œ -->
						{{#sessionComp.compname}}
							<button type="button" class="invisible"><h3>ğŸ¤</h3></button
							>{{/sessionComp.compname}}

						<span class="expiryDate fw-bold align-self-center me-2"
						>{{#expiryDate}}{{ expiryDate }}{{/expiryDate}}</span
						>
					</div>
				</div>
			</div>
			{{/postingList}}
		</div>
		</div>

		<div class="col-auto"></div>
	</div>

	<div id="customModal" class="modal" onclick="closeModal()">
		<div class="d-flex modal-content">
			<div class="d-flex justify-content-between align-content-center">
				<div id="print" class="d-inline text align-self-center">
					ëª¨ë‹¬ ë‚´ìš©ì„ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”.
				</div>
				<div class="align-self-end">
					<input
						id="applyPage"
						type="button"
						class="btn btn-sm btn-primary p-0 ps-1 pe-1 failButton"
						value="ë³´ëŸ¬ê°€ê¸°"
						style="
              display: flex;
              align-items: end;
              width: 65px;
              height: 25px;
              font-size: 14px;
            "
						onclick="applyPage()"
					/>
				</div>
				<div class="close d-inline" onclick="closeModal()">X</div>
			</div>
		</div>
	</div>

	<div id="modalBackdrop" class="modal-backdrop"></div>

	<input type="hidden" value="{{ json }}" name="json" id="json"/>
	<input
		type="hidden"
		value="{{ position }}"
		name="positionSet"
		id="positionSet"
	/>
	<input type="hidden" value="{{ region }}" name="regionSet" id="regionSet"/>

	{{#sessionUser}}
		<input type="hidden" value="{{ sessionUser.id }}" name="userId" id="userId"/>
		<input
			type="hidden"
			value="{{ sessionUser.username }}"
			name="username"
			id="username"
		/>

		<input
			type="hidden"
			value="{{ sessionUser.message }}"
			name="message"
			id="message"
		/>

		<input
			type="hidden"
			value="{{ sessionUser.stateChange }}"
			name="stateChange"
			id="stateChange"
		/>

	{{/sessionUser}}
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const likeButtons = document.querySelectorAll(".like-button");

			// ê°ê°ì˜ ì¢‹ì•„ìš” ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
			likeButtons.forEach((button) => {
				button.addEventListener("click", function () {
					// ë²„íŠ¼ì˜ í´ë˜ìŠ¤ë¥¼ í† ê¸€ (liked í´ë˜ìŠ¤ ì¶”ê°€/ì œê±°)
					button.classList.toggle("liked");

					// ë²„íŠ¼ì˜ í•˜íŠ¸ ì•„ì´ì½˜ ë³€ê²½
					const heartIcon = button.querySelector("h3");
					if (button.classList.contains("liked")) {
						heartIcon.textContent = "â¤ï¸";
					} else {
						heartIcon.textContent = "ğŸ¤";
					}
				});
			});
		});

		function toggleLike(postId) {
			// ì´ ë¶€ë¶„ì—ì„œ ì„œë²„ë¡œ ë¶ë§ˆí¬ ì¶”ê°€ ë˜ëŠ” ì œê±° ìš”ì²­ì„ ë³´ë‚´ê³ ,
			// ì„œë²„ì—ì„œ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ë©´ success ë˜ëŠ” error ì½œë°±ì„ ì²˜ë¦¬í•˜ì—¬
			// í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ í•˜íŠ¸ ëª¨ì–‘ì„ ë³€ê²½í•©ë‹ˆë‹¤.

			// AJAX ë˜ëŠ” Fetch APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì™€ í†µì‹ í•˜ì—¬ ë¶ë§ˆí¬ë¥¼ ì¶”ê°€ ë˜ëŠ” ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
			// ì´ ì˜ˆì‹œì—ì„œëŠ” ì„œë²„ ìš”ì²­ì´ ì„±ê³µí•˜ë©´ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ í•˜íŠ¸ ëª¨ì–‘ì„ ë³€ê²½í•˜ë„ë¡ ê°€ì •í•©ë‹ˆë‹¤.

			// postIdë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ ìš”ì²­ì„ êµ¬ì„±í•˜ê³ , ë¶ë§ˆí¬ ì¶”ê°€ ë˜ëŠ” ì œê±° ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.
			// ì„±ê³µì ì¸ ì‘ë‹µì„ ë°›ìœ¼ë©´ í•´ë‹¹ ê³µê³ ì˜ í•˜íŠ¸ ëª¨ì–‘ì„ ë³€ê²½í•©ë‹ˆë‹¤.

			const likeButton = document.querySelector(`[data-postid="${postId}"]`);

			// ì´ ë¶€ë¶„ì—ì„œ ì„œë²„ ìš”ì²­ì„ ë³´ë‚´ê³ , ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ ì‹œ ì ì ˆí•œ ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
			// ì„œë²„ë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ëŠ” ë°©ë²•ì€ AJAX ë˜ëŠ” Fetch APIë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

			// ì•„ë˜ ì˜ˆì‹œì—ì„œëŠ” ë‹¨ìˆœíˆ í•˜íŠ¸ ëª¨ì–‘ì„ í† ê¸€(toggle)í•©ë‹ˆë‹¤.
			if (likeButton.classList.contains("liked")) {
				likeButton.classList.remove("liked");
			} else {
				likeButton.classList.add("liked");
			}
		}

		function Ddaycheck(day) {
			if (typeof day === "string") {
				let day2 = new Date(day);
				return Ddaycheck(day2);
			} else {
				let today = new Date();

				// console.log((day-today) / (1000 * 60 * 60 * 24));
				let DDay = Math.ceil((day - today) / (1000 * 60 * 60 * 24));

				if (DDay == 0) {
					// console.log("D-Day");
					return "D-Day";
				} else if (DDay < 0) {
					// console.log("ë§Œë£Œ");
					return "ë§Œë£Œ";
				} else {
					// console.log("D-"+DDay);
					return "D-" + DDay;
				}
			}
		}

		let day = document.querySelectorAll(".expiryDate");
		day.forEach((element) => {
			element.textContent = Ddaycheck(element.textContent);
		});

		// ë‚ ì§œ D-Dayë¡œ ë°”ê¾¸ê¸°

		function skillCheck(selectAll) {
			let skillAll = document.querySelectorAll(".skillFind");
			// let allCheck=document.querySelector("#all");

			skillAll.forEach((element) => {
				element.checked = selectAll.checked;
			});
		}

		function skillAllCheck() {
			let allCheck = document.querySelector("#all");
			let skillAll = document.querySelectorAll(".skillFind");
			let skillAllCheck = document.querySelectorAll(".skillFind:checked");

			if (skillAll.length == skillAllCheck.length) {
				allCheck.checked = true;
			} else {
				allCheck.checked = false;
			}
		}

		// ê¸°ìˆ  ëª¨ë‘ ì²´í¬ë°•ìŠ¤ ì‘ë™í•˜ê²Œ

		//////////
		function check() {
			const json = JSON.parse(document.querySelector("#json").value);

			let skillCheckBoxAll = document.getElementById("all");

			if (json[0] != skillCheckBoxAll.value) {
				json.forEach((element) => {
					document.getElementById(element).checked = true;
				});
				skillCheckBoxAll.checked = false;
			} else {
				skillCheckBoxAll.checked = true;
				let skillFind2 = document.querySelectorAll(".skillFind");
				skillFind2.forEach((element) => {
					element.checked = true;
				});
			}
		}

		check();

		const positionSet = document.querySelector("#positionSet").value;
		if (positionSet == "all") {
			document.getElementById("all2").checked = true;
		} else {
			document.getElementById(positionSet).checked = true;
		}

		const regionSet = document.querySelector("#regionSet").value;
		if (regionSet == "all") {
			document.querySelector(".all3checkbox").checked = true;
		} else {
			document.getElementById(regionSet).selected = true;
		}

		////////// í˜„ì¬ ê²€ìƒ‰ì¤‘ì¸ê±° ë·° ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ë„ ì½ì–´ì˜¤ê²Œ

		function regionCheck(checkbox) {
			if (checkbox.checked) {
				document.getElementById("all3").selected = true;
			}
		}

		function regionCheck2(checkbox) {
			let select = checkbox.value;
			if (select == "all") {
				document.querySelector(".all3checkbox").checked = true;
			} else {
				document.querySelector(".all3checkbox").checked = false;
			}
		}

		// ì§€ì—­ë³„ ì„ íƒë°”-ëª¨ë‘ì²´í¬ë°•ìŠ¤ ì—°ë™

		function searchOnlyPosition() {
			document.querySelector("#pageFind").value = 0;

			document.querySelector(".all3checkbox").checked = true;
			document.getElementById("all3").selected = true;

			let skillfind = document.querySelectorAll(".skillFind");
			skillfind.forEach((element) => {
				element.checked = false;
			});
			document.querySelector("#all").checked = true;

			let submit = document.getElementById("selectform");
			submit.submit();
		}

		function searchOnlyRegion() {
			document.querySelector("#pageFind").value = 0;

			document.getElementById("all2").checked = true;

			let skillfind = document.querySelectorAll(".skillFind");
			skillfind.forEach((element) => {
				element.checked = false;
			});
			document.querySelector("#all").checked = true;

			let submit = document.getElementById("selectform");
			submit.submit();
		}

		function searchOnlySkill() {
			document.querySelector("#pageFind").value = 0;

			if (document.querySelector("#all").checked) {
				let skillfind = document.querySelectorAll(".skillFind");
				skillfind.forEach((element) => {
					element.checked = false;
				});
			}

			document.querySelector(".all3checkbox").checked = true;
			document.getElementById("all3").selected = true;

			document.getElementById("all2").checked = true;

			let submit = document.getElementById("selectform");
			submit.submit();
		}

		function searchAll() {
			document.querySelector("#pageFind").value = 0;

			if (document.querySelector("#all").checked) {
				let skillfind = document.querySelectorAll(".skillFind");
				skillfind.forEach((element) => {
					element.checked = false;
				});
			}
			let submit = document.getElementById("selectform");
			submit.submit();
		}

		function searchAllPagePlus() {
			pageFind = document.querySelector("#pageFind");
			// console.log(pageFind.value);
			pageFind.value++;
			// console.log(pageFind.value);

			if (document.querySelector("#all").checked) {
				let skillfind = document.querySelectorAll(".skillFind");
				skillfind.forEach((element) => {
					element.checked = false;
				});
			}
			let submit = document.getElementById("selectform");
			submit.submit();
		}

		function searchAllPageMinus() {
			pageFind = document.querySelector("#pageFind");
			// console.log(pageFind.value);
			pageFind.value--;
			// console.log(pageFind.value);

			if (document.querySelector("#all").checked) {
				let skillfind = document.querySelectorAll(".skillFind");
				skillfind.forEach((element) => {
					element.checked = false;
				});
			}
			let submit = document.getElementById("selectform");
			submit.submit();
		}

		let bookmarked = "<h3>â¤ï¸</h3>";
		let noBookmark = "<h3>ğŸ¤</h3>";
		let customModal = document.querySelector("#customModal");
		let modalBackdrop = document.querySelector("#modalBackdrop");

		async function bookmarkPoint(id) {
			// console.log('bookmarkPointì‹¤í–‰')
			// let response = await fetch(`/check?username=${username}`);
			let postingNum = document.querySelectorAll(".posting");
			// 		console.log(postingNum);

			let response = await fetch("/api/user/bookmark");
			// let bookmarkPoint = document.querySelector("#username").value;
			let body = await response.json();

			let dataArray = body.data;
			if (dataArray != null) {
				for (let item of dataArray) {
					let postingNum = document.querySelector(`#posting${item.id}`);
					let currentValue = postingNum.getAttribute("data-value");
					currentValue = true;
					postingNum.innerHTML = bookmarked;
					postingNum.setAttribute("data-value", currentValue);
				}
			}
		}

		// let response = await fetch("/api/tech?categoryId=" + categoryId);
		bookmarkPoint();

		async function bookmarkChange(id) {
			let postingNum = document.querySelector(`#posting${id}`);
			let currentValue = postingNum.getAttribute("data-value");

			if (currentValue == "true") {
				console.log(id);
				let response = await fetch(`/api/user/bookmark/${id}/delete`);
				let body = await response.json();

				if (body.sucuess == false) {
					// alert(body.data);
					openModal(body.data);
					customModal.focus();
					postingNum.blur();
				}
				if (body.sucuess == true) {
					// alert(body.data);
					document.querySelector("#applyPage").setAttribute("type", "hidden");
					openModal(body.data);
					customModal.focus();
					postingNum.blur();
					currentValue = false;
					postingNum.innerHTML = noBookmark;
				}
			} else {
				console.log(id);
				let response = await fetch(`/api/user/bookmark/${id}/save`);
				let body = await response.json();

				if (body.sucuess == false) {
					// alert(body.data);
					document.querySelector("#applyPage").setAttribute("type", "hidden");
					openModal(body.data);
					customModal.focus();
					postingNum.blur();
				}
				if (body.sucuess == true) {
					// alert(body.data);
					document.querySelector("#applyPage").setAttribute("type", "hidden");
					openModal(body.data);
					customModal.focus();
					postingNum.blur();
					currentValue = true;
					postingNum.innerHTML = bookmarked;
				}
			}

			postingNum.setAttribute("data-value", currentValue);
		}

		function openModal(string) {
			customModal.style.display = "block";
			let text = document.querySelector("#print");
			text.innerText = string;
			customModal.classList.add("active");
		}

		function closeModal() {
			console.log("closeModal ì‹¤í–‰");
			customModal.classList.remove("active");
			document.querySelector("#applyPage").setAttribute("type", "hidden");
			customModal.style.display = "none";
			messageCheckOut();
		}

		function closeBackdrop() {
			closeModal();
		}

		document.addEventListener("keydown", (event) => {
			if (event.key === "Enter" && customModal.style.display === "block") {
				closeModal();
			}
		});

		async function messageCheckOut() {
			let userId = document.querySelector("#userId").value;
			let username = document.querySelector("#username").value;
			console.log("userId : " + userId);
			console.log("username : " + username);

			let requestBody = {
				userId: userId,
				username: username,
			};

			let response = await fetch(`/api/user/ismessage`, {
				method: "post",
				headers: {
					"Content-Type": "application/json",
				},
				body: JSON.stringify(requestBody),
			});
		}

		// let content = document.querySelector("#reply").value;
		//   let userId = document.querySelector("#userId").value;
		//   console.log(content+"  "+ id+"  "+ userId);

		//   let response = await fetch(`/api/master/${id}/saveReply`, {
		//     method: "post",
		//     headers: {
		//       "Content-Type": "application/json",
		//     },
		//     body: JSON.stringify(requestBody),
		//   });

		//   let result = await response.json();
		//   console.log(result);

		let string = "[ì•Œë¦¼] \n";

		function messageCheck() {
			let message;
			if (document.querySelector("#message")) {
				message = document.querySelector("#message").value;
				stateChange = document.querySelector("#stateChange").value;
				// message = document.querySelector("#message").value;
				console.log("ë©”ì„¸ì§€ ì²´í¬ ì‹¤í–‰ë¨ message : " + message);
				if (message == "true") {
					console.log("ëª¨ë‹¬ ì‹¤í–‰  message : " + message);
					string += "\n ë¬¸ì˜ì— ëŒ€í•œ ë‹µë³€ì´ ë‹¬ë ¸ìŠµë‹ˆë‹¤.";
					document.querySelector("#applyPage").setAttribute("onclick", "questionListPage()");
					openModal(string);
					string = "[ì•Œë¦¼] \n";
					if (stateChange != "true") {
						messageCheckOut();
					}
				}

				if (stateChange == "true") {
					console.log("ëª¨ë‹¬ ì‹¤í–‰  stateChange : " + stateChange);
					string += "\n ì§€ì›ê²°ê³¼ê°€ ë°œí‘œë˜ì—ˆìŠµë‹ˆë‹¤!";
					document.querySelector("#applyPage").setAttribute("onclick", "applyPage()");
					openModal(string);
					messageCheckOut();
				}
			}
		}

		messageCheck();

		function applyPage() {
			messageCheckOut();
			location.href = "/user/apply/list";
		}


		function questionListPage() {
			messageCheckOut();
			location.href = "/question/List";
		}
	</script>

{{> layout/footer}}